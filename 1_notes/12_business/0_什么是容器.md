## 什么是容器

### 1. 基本概念

​	随着云技术的发展，部署一个服务器往往不再需要真的搭建一个服务器机房，而是通过云服务器的方式。这使得服务器主机、网络、存储的资源利用率得到极大地提升。现在，我们可以非常快捷地通过各大云服务器平台，得到一个可用的虚拟机。

​	而得到一个可用的虚拟机不是我们的目的，得到一个有用的虚拟机才是我们的目的，也就是部署了业务的虚拟机。我们需要让应用程序在虚拟机中跑起来。如果虚拟机或者说服务器不多，一个一个安装即可。可如果成百上千呢？特别是一个应用程序，可能会有不同的环境依赖，对操作系统平台、数据库版本、Python解释器等等各种依赖。比如说我一个服务器，A应用要求py3.5,B应用要求py3.7。不是说不能够通过选择环境依赖解决，但实现起来还是很麻烦的。

​	因此，一个能够快速部署到多个、不同的服务器的技术是很重要的。这也就是容器技术，其最本质的内容就是将应用程序所需要的所有环境打包到一块。但这整个的思想，还可以扩展出来以下概念。

### 2. 进一步概念

​	容器技术是可以通过压缩技术类比的，首先**镜像**好比压缩文件，我们需要将环境、应用程序各种东西打包成一个压缩文件，再通过一个**容器引擎**将这些**容器镜像**生成**实例**，这就有点像通过WinRAR将xxx.zip解压为xxx.exe的过程。

​	而在这基础上，我们还需要考虑到**容器镜像**如何获取，**实例**如何管理。**镜像**是事先存储在**容器仓库**的，因此我们从**容器仓库**即可下载获取**镜像**。**容器仓库**则类似于AppStore。因为在企业中，容器一般都是同时部署着成百上千个，不可能逐一去管理，因此我们希望有一个统一的方式对**实例**进行集中管理，这个就被称为**容器编排**，有点类似于任务管理器。任务管理器也是同时运行着很多个进程。

|          | 镜像       | 镜像仓库   | 容器引擎   | 实例     | 容器编排     |
| -------- | ---------- | ---------- | ---------- | -------- | ------------ |
| 程序类比 | xxx.zip    | AppStore   | WinRAR     | xxx.exe  | 任务管理器   |
| 工作性质 | 压缩包文件 | 文件服务器 | 虚拟化工具 | 运行进程 | 资源调度器   |
| 应用角度 | 交付格式   | 应用分发   | 运行环境   | 运行环境 | 声明周期管理 |

### 3. Q&A

#### 3.1 容器和虚拟机技术的联系

​	如果只是从功能上来看，两者是很相似的。但是虚拟机一般来说只有镜像，没有仓库、引擎、实例、编排等划分，但不代表虚拟机不可以这么做。只是容器相较于虚拟机更轻量，更实用。

| 特性       | 容器     | 虚拟机 |
| ---------- | -------- | ------ |
| 启动       | 秒级     | 分钟级 |
| 硬盘使用   | MB       | GB     |
| 性能       | 接近原生 | 弱于   |
| 单机支持量 | 上千个   | 几十个 |

​	两者的区别在于，虚拟机是虚拟出一套硬件资源后，运行了一个完整的操作系统；而容器是直接运行在宿主的内核中。因此，容器内部没有内核，也没有进行硬件虚拟。

#### 3.2 什么是docker和kubernetes(k8s)

​	简单来说docker近实现了镜像、仓库、引擎、示例等部分，至于容器编排是之后加的方案，通过compose+swarm方案综合实现；而k8s在docker的基础上多了容器编排这一个部分，可以说k8s是docker的超集。而k8s在容器编排上技术比docker更好，成为了容器编排的标准。



### 附录

1. [video: docker 10分钟快速入门](https://www.youtube.com/watch?v=mPquwpxyUQU)
2. [video: k8s 10分钟快速入门](https://www.youtube.com/watch?v=ubz3cFgxeJA)
3. [docs: docker-从入门到实践](https://yeasy.gitbook.io/docker_practice)