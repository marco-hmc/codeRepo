---
title: "计算机组成与硬件"
layout: post
author: "Marco"
header-style: text
hidden: true
tags:
  - 计算机组成
---

# 计算机组成与硬件

## 1. CPU工作原理

![1601363919547](https://s2.loli.net/2022/01/21/xUvaARYc1yFNWK4.png)

CPU从功能上可以分为三个模块，分别是控制单元、运算单元以及存储单元。

* 控制单元
  *  控制单元是整个CPU的指挥控制中心，由指令寄存器IR（Instruction Register）、指令译码器ID（Instruction Decoder）和 操作控制器OC（Operation Controller） 等组成，对协调整个电脑有序工作极为重要。它根据用户预先编好的程序，依次从存储器中取出各条指令，放在指令寄存器IR中，通过指令译码（分析）确定应该进行什么操作，然后通过操作控制器OC，按确定的时序，向相应的部件发出微操作控制信号。操作控制器OC中主要包括：节拍脉冲发生器、控制矩阵、时钟脉冲发生器、复位电路和启停电路等控制逻辑。 
* 运算单元
  * 运算单元是运算器的核心。可以执行算术运算（包括加减乘数等基本运算及其附加运算）和逻辑运算（包括移位、逻辑测试或两个值比较）。相对控制单元而言，运算器接受控制单元的命令而进行动作，即运算单元所进行的全部操作都是由控制单元发出的控制信号来指挥的，所以它是执行部件。 
*  存储单元
  * 存储单元包括 CPU 片内缓存和寄存器组，是 CPU 中暂时存放数据的地方，里面保存着那些等待处理的数据，或已经处理过的数据，CPU 访问寄存器所用的时间要比访问内存的时间短。采用寄存器，可以减少 CPU 访问内存的次数，从而提高了 CPU 的工作速度。寄存器组可分为专用寄存器和通用寄存器。专用寄存器的作用是固定的，分别寄存相应的数据；而通用寄存器用途广泛并可由程序员规定其用途。 

### 1.1 CPU cache

* **为什么有了内存，还需要CPU Cache？**

  > 根据摩尔定律，CPU 的访问速度每 18 个月就会翻倍，相当于每年增长 60% 左右，内存的速度当然也会不断增长，但是增长的速度远小于 CPU，平均每年只增长 7% 左右。于是，CPU 与内存的访问性能的差距不断拉大。
  >
  > 到现在，一次内存访问所需时间是 `200~300` 多个时钟周期，这意味着 CPU 和内存的访问速度已经相差 `200~300` 多倍了。
  >
  > 为了弥补 CPU 与内存两者之间的性能差异，就在 CPU 内部引入了  CPU Cache，也称高速缓存。
  >
  > CPU Cache 通常分为大小不等的三级缓存，分别是 **L1 Cache、L2 Cache 和 L3 Cache**。

* **为什么CPU Cache不能设计大一些？**

  >  由于 CPU Cache 所使用的材料是 SRAM，价格比内存使用的 DRAM 高出很多，在当今每生产 1 MB 大小的 CPU Cache 需要 7 美金的成本，而内存只需要 0.015 美金的成本，成本方面相差了 466 倍，所以 CPU Cache 不像内存那样动辄以 GB 计算，它的大小是以 KB 或 MB 来计算的。 

* **L1 Cache、L2 Cache、L3 Cache的异同**

  > ![1603417819815](https://s2.loli.net/2022/01/21/WTMymqc8G19jK6b.png)
  >
  > ![1603417832373](https://s2.loli.net/2022/01/21/4qax7vWJnIHjRD9.png)
  >
  > ![1603418066134](https://s2.loli.net/2022/01/21/Mpujv91qI3eSw2C.png)

## 2. 内存和硬盘读写

- 内存工作原理

  - 内存中的cell按矩阵形排列，每一行和每一列都会有一个对应的行地址线路（正规叫法叫做word line）和列地址线路（正规叫法是bit line），每个具体的cell就挂接在这样的行地址线路和列地址线路上，对应一个唯一的行号和列号，把行号和列号组合在一起，就是内存的地址。

  - [video-内存的工作原理-内存是怎么存数据的？](https://www.youtube.com/watch?v=aO_kBa9DzPQ)

    > 内存是以页为单位进行存储的

  - [linux内存页大小](https://blog.csdn.net/qq_35995514/article/details/113060907)

- 硬盘工作原理
  - [video-硬盘工作原理-硬盘如何存储数据](https://www.youtube.com/watch?v=svhIPM2VT8U)
  - [video-硬盘工作原理-硬盘如何存储数据2](https://www.youtube.com/watch?v=UNLEvvmcyWA)
  - 简单来说，硬盘是以一个页进行读取的

- 缓存

  ​	从寄存器、`L1/L2`高速缓存、内存、闪存，到磁盘/光盘/磁带/存储网络，计算机的各级存储器硬件组成了一个金字塔结构。越是底层存储容量越大。然而访问速度也越慢，具体表现为更小的带宽和更大的延迟。因而这很自然的便成为一个金字塔形的逐层缓存结构。由此产生了三类基本的缓存管理和优化问题：

  - 缓存三类管理问题
    - 预读
      - 即将读取前后一片数据都提前读取到缓存中，因为磁盘IO读写最大的问题在于硬盘的寻址过程，所以这里额外读取数据的代价很小。除此之外，这些前后数据很有可能是下一次的读写数据。
      - [linux内核文件预读机制详解](https://blog.csdn.net/kunyus/article/details/104620057)
    - 替换
      - 从缓存中丢弃无用数据;
    - 写回
      - 把脏数据从缓存中保存到慢速存储
  - 缓存命中率
    - [缓存命中率介绍](https://blog.csdn.net/qq_22585453/article/details/110080900)



