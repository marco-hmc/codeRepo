# 摘要算法

* 常见摘要算法有：MD5、SHA1、SHA256、SHA384、SHA512

## MD5

* **MD5信息摘要算法**（MD5 Message-Digest Algorithm），一种被广泛使用的密码散列函数，可以产生出一个**128位**（16字节）的散列值（hash value），用于确保信息传输完整一致。是一种不可逆过程，

* 1996年后该算法被证实存在弱点，可以被加以破解，对于需要高度安全性的数据，专家一般建议改用其他算法，如SHA-2等

* 可以在这些地方使用摘要算法：明文密码取摘要后把摘要存入数据库、文件断点续传与秒传（用**文件摘要确定唯一性**）、不在网络中传输密码（密码做摘要后传输，在服务器端取出密码用相同的摘要算法计算摘要后再跟客户端传过来的摘要比对）

* 算法原理

  * 经过程序流程，生成四个32位数据，最后联合起来成为一个128-bits散列。基本方式为，求余、取余、调整长度、与链接变量进行循环运算

* 算法流程

  * 按位补充数据

    * 在MD5算法中，首先需要对信息进行填充，这个数据按位(bit)补充，要求最终的位数对512求模的结果为448。也就是说数据补位后，其位数长度只差64位(bit)就是512的整数倍，**即便是这个数据的位数对512求模的结果正好是448也必须进行补位**
    * 补位的实现过程：首先在数据后补一个1 bit； 接着在后面补上一堆0 bit, 直到整个数据的位数对512求模的结果正好为448。总之，至少补1位，而最多可能补512位

  * 扩展长度

    * 在完成补位工作后，又将一个**表示数据原始长度**的64 bit数(这是对原始数据没有补位前长度的描述，用二进制来表示)**补在最后**。当完成补位及补充数据的描述后，得到的结果数据长度正好是512的整数倍。也就是说长度正好是16个(32bit) 字的整数倍

  * 初始化MD缓存器

    * MD5运算要用到一个128位的MD5缓存器，用来保存中间变量和最终结果。该缓存器又可看成是4个32位的寄存器A、B、C、D，初始化为(大段表示)
      * A ： 01 23 45 67
      * B： 89 ab cd ef
      * C： fe dc ba 98
      * D： 76 54 32 10

  * 处理数据段

    * 首先定义4个非线性函数F、G、H、I，对输入的报文运算以512位数据段为单位进行处理。对每个数据段都要进行4轮的逻辑处理，在4轮中分别使用4个不同的函数F、G、H、I。每一轮以ABCD和当前的512位的块为输入，处理后送入ABCD覆盖旧值(128位)作为下一轮的输入

      <img src="imgs/encryption%20algorithm/md51.png" alt="md51" style="zoom:80%;" />

  * 输出

    * 信息摘要最终处理成以A, B, C, D 的形式输出。也就是开始于A的低位在前的顺序字节，结束于D的高位在前的顺序字节

* 流程图

  <img src="imgs/encryption%20algorithm/md52.png" alt="md52" style="zoom:80%;" />

# 对称加密算法

* 常用的对称加密算法有：**DES**、3DES、TDEA、Blowfish、RC2、RC4、RC5、IDEA、SKIPJACK、**AES**等

* 对称加密可以理解为加密与解密都使用同一套算法

* 下图是一个经典对称加密算法。采用字母移位的办法对原始字符串进行转换，解密时再根据之前的移位,转换为原始字符串。可以根据此种算法，设计一个密码机，输入移位n，自动进行编码与解码

  <img src="imgs/encryption%20algorithm/symetric.png" alt="symetric" style="zoom:80%;" />

# 非对称加密

* 常用的非对称加密算法有：**RSA**、Elgamal、背包算法、Rabin、**D-H**、ECC（椭圆曲线加密算法）等

* 非对称加密的密钥分为公钥和私钥，其中公钥和私钥都可以加密与解密。特别的是，公钥所加密的内容只有私钥能够解密。这样，对于服务器来讲，只需要把公钥分发给所有客户，自己保存好私钥即可

* 由下图可以看出，左侧的对称加密为A、B、C、D四个用户分别分配了一个密钥，而右侧的非对称加密（也叫公开密钥加密技术）为A、B、C、D四个用户分配了相同的密钥。

  <img src="imgs/encryption%20algorithm/asymetric.png" alt="asymetric" style="zoom:80%;" />

# 数字签名

* 数字签名可以理解为`摘要算法`与`非对称加密`的综合使用

* 数字签名可以对应为经常见到的骑缝章（经常有人喜欢把名字写在书的侧面）。**数字签名需要说明是谁编写的报文，同时证明报文未被篡改过**

* 通过下图，可以清楚的看出，使用`摘要算法`来证明报文未被篡改过，使用`非对称加密`来说明**是谁写的报文**

  <img src="imgs/encryption%20algorithm/digital_signature.png" alt="digital_signature" style="zoom:80%;" />