## tracy-profiler

### 1. concepts

#### 1.1 tracy-profiler是什么？

`tracy-profiler` 是一个开源的性能分析工具，专为高性能应用程序设计。它提供了详细的帧分析和性能分析功能，能够实时显示应用程序的性能数据。`tracy-profiler` 主要用于 C++ 应用程序，但也支持其他语言的绑定。

* **主要功能**

1. **实时性能分析**：
   `tracy-profiler` 能够实时显示应用程序的性能数据，包括帧时间、CPU 使用率、内存使用情况等。

2. **详细的帧分析**：
   `tracy-profiler` 提供了详细的帧分析功能，可以帮助开发者了解每一帧的执行时间和各个部分的性能表现。

3. **多线程支持**：
   `tracy-profiler` 支持多线程应用程序，能够显示每个线程的性能数据和执行情况。

4. **内存分配跟踪**：
   `tracy-profiler` 可以跟踪内存分配和释放情况，帮助开发者发现内存泄漏和不合理的内存使用。

5. **自定义事件**：
   开发者可以在代码中插入自定义事件，`tracy-profiler` 会记录这些事件的发生时间和持续时间，帮助开发者了解特定代码段的性能表现。


#### 1.2 tracyProfiler如何使用？需要配置什么？

1. **下载并编译Tracy**:你可以从Tracy的GitHub页面下载源代码,并使用你的编译器编译它.编译完成后,你会得到一个名为`libtracy.a`的静态库文件.

2. **在你的项目中链接Tracy库**:你需要在你的项目的编译设置中添加Tracy库.具体的步骤取决于你的编译器和构建系统.一般来说,你需要添加Tracy库的路径到你的链接器设置,并添加`-ltracy`到你的链接器标志.

3. **在你的代码中插入Tracy的宏**:你需要在你想要分析的代码段前后添加Tracy的宏.例如,你可以使用`ZoneScoped`宏来标记一个代码块的开始和结束.

```cpp
#include "Tracy.hpp"

void FunctionToProfile()
{
    ZoneScoped;  // 开始一个新的分析区域

    // 这里是你想要分析的代码
    for(int i = 0; i < 1000000; ++i)
    {
        // ...
    }
}
```

4. **运行Tracy Profiler的服务器程序**:Tracy Profiler包含一个名为`tracy.exe`的服务器程序.你需要运行这个程序来收集和查看性能数据.你可以在Tracy的GitHub页面下载这个程序.

5. **运行你的程序**:现在,你可以运行你的程序.Tracy Profiler会自动收集性能数据,并在其用户界面中显示.

以上就是使用Tracy Profiler的基本步骤.需要注意的是,Tracy Profiler的设计目标是实时性能分析,所以它对性能的影响非常小,可以在开发和测试阶段持续使用.


#### 1.3 tracyProfiler的工作原理是什么
Tracy Profiler的工作原理主要基于插桩(Instrumentation)和数据可视化两个方面.

1. **插桩标记分析代码区域**：
   在需要分析的代码区域插入 `Tracy` 的接口（宏或函数调用）。这些接口会标记代码的开始和结束位置，记录性能数据。

2. **自动收集性能信息**：
   `Tracy` 的接口会自动收集所需的性能信息，包括函数调用的开始和结束时间、线程状态、内存分配等。

3. **通过 Socket 接口发送数据**：
   收集到的性能数据会通过网络（Socket 接口）发送到 `Tracy` 的客户端程序。这个过程是实时进行的，确保性能数据能够及时传输。

4. **在客户端程序查看性能数据**：
   `Tracy` 的客户端程序接收到性能数据后，会在图形界面中展示这些数据。用户可以通过客户端程序实时查看和分析性能数据，找到性能瓶颈和优化点。

